<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Login JWT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script defer>
        async function login(event) {
          event.preventDefault();

          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          const response = await fetch("/auth/log-in", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({ username, password })
          });

          const result = await response.json();

          if (response.ok) {
            localStorage.setItem("jwtToken", result.accessToken);
            alert("Login exitoso ✔️");

            // Redirigir o cargar otra página segura
            window.location.href = "/web/home"; // ejemplo

          } else {
            document.getElementById("error-message").innerText = "Credenciales incorrectas.";
          }
        }
    </script>
</head>
<body class="d-flex align-items-center justify-content-center vh-100 bg-light">

<div class="card shadow-lg p-4" style="width: 22rem;">
    <h3 class="text-center mb-4">Iniciar Sesión</h3>

    <form onsubmit="login(event)">
        <div class="mb-3">
            <label for="username" class="form-label">Usuario</label>
            <input type="text" id="username" name="username" class="form-control" required>
        </div>
        <div class="mb-3">
            <label for="password" class="form-label">Contraseña</label>
            <input type="password" id="password" name="password" class="form-control" required>
        </div>
        <div id="error-message" class="text-danger mb-3"></div>
        <button type="submit" class="btn btn-primary w-100">Ingresar</button>
        <a href="/web/registro" class="btn btn-success w-100 mt-2">
            <i class="fas fa-user-plus"></i> Registrarse
        </a>
    </form>

    <div class="text-center mt-3">
        <a href="/oauth2/authorization/github" class="btn btn-dark w-100">
            <i class="fab fa-github"></i> Iniciar sesión con GitHub
        </a>
    </div>
</div>

</body>
</html>